{% extends "admin/base.html" %}
{% block title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ{% endblock %}
{% block content %}
{% csrf_token %}

<style>
    /* ğŸ” SAME STYLES FROM RESELLER LIST (UNCHANGED) */
    .search-form {
        display: flex;
        gap: 10px;
        align-items: center;
        margin-bottom: 1.5rem;
        direction: rtl;
    }

    .search-form input {
        flex: 1;
        min-width: 260px;
        height: 48px;
        padding: 0 14px;
        font-size: 16px;
        border-radius: 10px;
        border: 1px solid #d1d5db;
    }

    .search-form button {
        height: 48px;
        padding: 0 22px;
        border-radius: 10px;
        background: #991b1b;
        color: white;
        font-weight: 600;
        border: none;
        cursor: pointer;
    }

    .admin-table {
        width: 100%;
        border-collapse: collapse;
    }

    .admin-table th,
    .admin-table td {
        padding: 14px;
        border-bottom: 1px solid #eee;
        text-align: right;
    }

    .admin-table th {
        background: #f9fafb;
        font-weight: 700;
    }

    .admin-table td[data-label="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"] a {
        margin-left: 6px;
    }

    @media (max-width: 640px) {

        .admin-table,
        .admin-table thead,
        .admin-table tbody,
        .admin-table th,
        .admin-table td,
        .admin-table tr {
            display: block;
            width: 100%;
        }

        .admin-table thead {
            display: none;
        }

        .admin-table tr {
            background: #fff;
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 16px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.06);
        }

        .admin-table td {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            direction: rtl;
            font-size: 14px;
        }

        .admin-table td:last-child {
            border-bottom: none;
        }

        .admin-table td::before {
            content: attr(data-label);
            font-weight: 700;
            color: #555;
        }

        .admin-table td[data-label="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"] {
            flex-direction: column;
            gap: 8px;
        }

        .admin-table td[data-label="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª"] a {
            width: 100%;
            text-align: center;
        }
    }
</style>

<div style="margin-bottom: 2rem;">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;">
        <h2>Ù…ÙˆØ¸ÙÙŠ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h2>
        <a href="{% url 'adminpanel:tech_support_add' %}" class="btn btn-primary">
            Ø¥Ø¶Ø§ÙØ© Ø¯Ø¹Ù… ÙÙ†ÙŠ
        </a>
    </div>

    <table class="admin-table">
        <thead>
            <tr>
                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                <th>Ø§Ù„Ø§Ø³Ù…</th>
                <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
        </thead>
        <tbody>
            {% for tech in tech_supports %}
            <tr>
                <td data-label="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">{{ tech.user.username }}</td>
                <td data-label="Ø§Ù„Ø§Ø³Ù…">{{ tech.name }}</td>
                <td data-label="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">{{ tech.phone }}</td>
                <td data-label="Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª">
                    <a href="{% url 'adminpanel:tech_support_edit' tech.id %}" class="btn btn-warning">
                        ØªØ¹Ø¯ÙŠÙ„
                    </a>
                    <a href="{% url 'adminpanel:tech_support_delete' tech.id %}" class="btn btn-danger" data-confirm
                        data-msg="Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù…ÙˆØ¸Ù Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.">
                        Ø­Ø°Ù
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align:center">
                    Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙˆØ¸ÙÙŠ Ø¯Ø¹Ù… ÙÙ†ÙŠ Ø­Ø§Ù„ÙŠØ§Ù‹
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- âœ… CONFIRM DELETE MODAL (SAME AS RESELLERS) -->
<div id="confirmModal" style="display:none;position:fixed;inset:0;z-index:50;">
    <div id="cmBack" style="position:absolute;inset:0;background:rgba(0,0,0,.3);"></div>

    <div style="position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
                background:#fff;padding:20px;border-radius:10px;max-width:420px;width:92%;">
        <p id="cmText"></p>
        <div style="margin-top:16px;display:flex;justify-content:flex-end;gap:10px;">
            <button id="cmCancel" class="btn">Ø¥Ù„ØºØ§Ø¡</button>
            <a id="cmOk" class="btn btn-danger">Ø­Ø°Ù</a>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const modal = document.getElementById("confirmModal");
        const text = document.getElementById("cmText");
        const ok = document.getElementById("cmOk");
        const cancel = document.getElementById("cmCancel");
        const back = document.getElementById("cmBack");

        let target = null;

        document.querySelectorAll("[data-confirm]").forEach(btn => {
            btn.addEventListener("click", e => {
                e.preventDefault();
                target = btn.href;
                text.textContent = btn.dataset.msg || "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ";
                modal.style.display = "block";
            });
        });

        cancel.onclick = back.onclick = () => modal.style.display = "none";
        ok.onclick = () => target && (window.location.href = target);
    });
</script>

{% endblock %}